<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tomar foto y subir (380x250 B/N)</title>
<style>
  body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial; padding: 1rem; max-width: 520px; margin: auto; }
  video, canvas, img { max-width: 100%; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.12); }
  .controls { margin-top: 0.75rem; display:flex; gap:.5rem; flex-wrap:wrap; }
  button { padding: .6rem .9rem; border-radius: 8px; border: none; background:#0b76ff; color:white; font-weight:600; cursor:pointer; }
  button.secondary { background:#6b7280; }
  #status { margin-top:.75rem; color:#333; }
  #previewWrap { margin-top:.75rem; display:flex; gap:.6rem; align-items:center; }
  #previewLabel { font-size:.9rem; color:#444; }
  input[type=file] { display:none; }
</style>
</head>
<body>
  <h1>Foto 380√ó250 B/N ‚Üí POST /upload</h1>

  <div id="cameraArea">
    <video id="video" playsinline autoplay style="display:none;"></video>
    <div class="controls">
      <button id="startCam">Abrir c√°mara</button>
      <button id="takePhoto" class="secondary" disabled>Tomar foto</button>
      <label for="fileInput" style="display:inline-block">
        <button type="button" id="chooseFile" class="secondary">Subir foto (fallback)</button>
      </label>
      <button id="stopCam" class="secondary" disabled>Detener c√°mara</button>
    </div>
    <input id="fileInput" accept="image/*" capture="environment" type="file">
  </div>
  <div class="row" style="margin:1rem 0;">
    <button id="btnConnect" class="primary">üîó Conectar impresora</button>
    <button id="btnPrintImage" class="secondary" disabled>üñºÔ∏è Imprimir Imagen</button>
    <button id="btnDisconnect" class="secondary" disabled>‚èèÔ∏è Desconectar</button>
  </div>

  <div id="previewWrap">
    <div>
      <div id="previewLabel">Preview (380√ó250 B/N):</div>
      <canvas id="canvas" width="380" height="250" style="display:block; margin-top:.5rem;"></canvas>
    </div>
    <div>
      <div id="uploadLabel">Estado:</div>
      <div id="status">Listo.</div>
    </div>
  </div>
  <div id="log" class="log" role="log" aria-live="polite"></div>

<script src='dist/receipt-printer-encoder.umd.js'></script>
<script src="camera-printer.js"></script>
</body>
</html>
